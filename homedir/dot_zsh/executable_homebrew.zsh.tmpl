{{- if eq .chezmoi.os "darwin" -}}
eval "$(/opt/homebrew/bin/brew shellenv)"
{{- else if eq .chezmoi.os "linux" -}}
eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
{{ else }}
echo "Error: Homebrew not supported on OS: {{ .chezmoi.os }} Arch: {{ .chezmoi.arch }}" && exit 1
{{ end }}

BREW_PREFIX=$(brew --prefix)
if [[ -z "${CPPFLAGS:-}" || "${CPPFLAGS:-}" != *"${BREW_PREFIX}/include"* ]]; then
  export CPPFLAGS="${CPPFLAGS:--I${BREW_PREFIX}/include}"
fi
if [[ -z "${LDFLAGS:-}" || "${LDFLAGS:-}" != *"${BREW_PREFIX}/lib"* ]]; then
  export LDFLAGS="${LDFLAGS:--L${BREW_PREFIX}/lib}"
fi
if [[ -z "${PKG_CONFIG_PATH:-}" || "${PKG_CONFIG_PATH:-}" != *"${BREW_PREFIX}/lib/pkgconfig"* ]]; then
  export PKG_CONFIG_PATH="${PKG_CONFIG_PATH:-}${PKG_CONFIG_PATH:+:}${BREW_PREFIX}/lib/pkgconfig"
fi
if [[ -d "${BREW_PREFIX}/bin" && "$PATH" != *"${BREW_PREFIX}/bin"* ]]; then
  export PATH="${BREW_PREFIX}/bin:$PATH"
fi

# ───── History settings ─────
export HISTFILE="$HOME/.config/zshrc.d/.zsh_history"   # ← change this line

HISTSIZE=50000          # how many lines to keep in memory
SAVEHIST=40000          # how many lines to save to disk
setopt APPEND_HISTORY   # append instead of overwrite
setopt INC_APPEND_HISTORY   # write to file immediately
setopt SHARE_HISTORY        # share history between sessions
setopt HIST_IGNORE_DUPS     # ignore duplicate commands
